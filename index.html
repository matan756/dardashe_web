function countTotalExercises() {
  const mainFolderId = '14Eodv8ax-bH0iK49N3fr43bnnZKuA9Q0';
  const mainFolder = DriveApp.getFolderById(mainFolderId);
  
  let totalRows = 0;
  let totalFiles = 0;

  function processFolder(folder) {
    // Process all Google Sheets in this folder
    const files = folder.getFilesByType(MimeType.GOOGLE_SHEETS);
    while (files.hasNext()) {
      const file = files.next();
      totalFiles++; // Count how many sheet files were processed
      const ss = SpreadsheetApp.openById(file.getId());
      const sheets = ss.getSheets();
      for (const sheet of sheets) {
        const data = sheet.getDataRange().getValues();
        if (data.length > 1) {
          const nonEmptyRows = data.slice(1).filter(row => row.some(cell => cell !== '')).length;
          totalRows += nonEmptyRows;
        }
      }
    }

    // Process subfolders recursively
    const subfolders = folder.getFolders();
    while (subfolders.hasNext()) {
      processFolder(subfolders.next());
    }
  }

  processFolder(mainFolder);

  Logger.log(`âœ… Total exercises (rows excluding headers): ${totalRows}`);
  Logger.log(`ðŸ“„ Total Google Sheet files checked: ${totalFiles}`);
  
  return totalRows;
}
